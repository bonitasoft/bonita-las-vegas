{
  "designerVersion" : "1.9.24",
  "previousDesignerVersion" : "1.7.69",
  "id" : "addExpense",
  "name" : "addExpense",
  "lastUpdate" : 1560806959308,
  "rows" : [ [ {
    "type" : "container",
    "dimension" : {
      "xs" : 12
    },
    "propertyValues" : { },
    "reference" : "10c6ea20-5715-4890-a809-6b19ab2bcc41",
    "hasValidationError" : false,
    "id" : "pbContainer",
    "rows" : [ [ {
      "type" : "component",
      "dimension" : {
        "md" : 12,
        "sm" : 12,
        "xs" : 12,
        "lg" : 12
      },
      "propertyValues" : {
        "labelHidden" : {
          "type" : "constant",
          "value" : false
        },
        "readonly" : {
          "type" : "constant",
          "value" : false
        },
        "level" : {
          "type" : "constant",
          "value" : "Level 1"
        },
        "cssClasses" : {
          "type" : "constant",
          "value" : ""
        },
        "widgetId" : {
          "type" : "constant",
          "value" : "pbTitle"
        },
        "isDisplayed" : {
          "type" : "constant",
          "value" : true
        },
        "label" : {
          "type" : "interpolation"
        },
        "text" : {
          "type" : "interpolation",
          "value" : "{{ task.displayName }}"
        },
        "alignment" : {
          "type" : "constant",
          "value" : "center"
        },
        "class" : {
          "type" : "constant",
          "value" : "org.bonitasoft.web.designer.experimental.parametrizedWidget.TitleWidget"
        },
        "dimension" : {
          "type" : "constant",
          "value" : 12
        },
        "hidden" : {
          "type" : "constant",
          "value" : false
        }
      },
      "reference" : "30b0cd4a-ae1c-45cf-9a40-3c79dee74c6c",
      "hasValidationError" : false,
      "id" : "pbTitle"
    } ], [ {
      "type" : "component",
      "dimension" : {
        "md" : 12,
        "sm" : 12,
        "xs" : 12,
        "lg" : 12
      },
      "propertyValues" : {
        "labelHidden" : {
          "type" : "constant",
          "value" : false
        },
        "readonly" : {
          "type" : "constant",
          "value" : false
        },
        "cssClasses" : {
          "type" : "constant",
          "value" : ""
        },
        "widgetId" : {
          "type" : "constant",
          "value" : "pbText"
        },
        "isDisplayed" : {
          "type" : "constant",
          "value" : true
        },
        "label" : {
          "type" : "interpolation"
        },
        "text" : {
          "type" : "interpolation",
          "value" : "{{ task.displayDescription }}"
        },
        "alignment" : {
          "type" : "constant",
          "value" : "left"
        },
        "class" : {
          "type" : "constant",
          "value" : "org.bonitasoft.web.designer.experimental.parametrizedWidget.TextWidget"
        },
        "dimension" : {
          "type" : "constant",
          "value" : 12
        },
        "labelPosition" : {
          "type" : "constant",
          "value" : "top"
        },
        "labelWidth" : {
          "type" : "constant",
          "value" : 4
        }
      },
      "reference" : "3b237c1e-205e-49fe-88f3-97af6844705e",
      "hasValidationError" : false,
      "id" : "pbText"
    } ] ]
  } ], [ {
    "type" : "formContainer",
    "dimension" : {
      "xs" : 12,
      "sm" : 12,
      "md" : 12,
      "lg" : 12
    },
    "propertyValues" : {
      "cssClasses" : {
        "type" : "constant",
        "value" : ""
      },
      "hidden" : {
        "type" : "constant",
        "value" : false
      }
    },
    "reference" : "8067dea5-216f-4fc1-8d6a-85e9f924ff58",
    "hasValidationError" : false,
    "id" : "pbFormContainer",
    "container" : {
      "type" : "container",
      "dimension" : {
        "xs" : 12
      },
      "propertyValues" : { },
      "reference" : "cf85459d-3aad-4063-9707-05fbbde49eb5",
      "hasValidationError" : false,
      "id" : "pbContainer",
      "rows" : [ [ {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 3,
          "lg" : 4
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "1ae25948-35e8-4170-9e71-7b269085f020",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [ [ ] ]
      }, {
        "type" : "fragment",
        "dimension" : {
          "md" : 6,
          "sm" : 12,
          "xs" : 12,
          "lg" : 4
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          }
        },
        "reference" : "a673cdbd-8a9c-47f8-8b19-2f084249fa24",
        "hasValidationError" : false,
        "id" : "expenseEdition",
        "binding" : {
          "expense" : "formInput",
          "isKm" : "isKm",
          "kmAmount" : "kmAmount",
          "currencies" : "currencies",
          "expenseTypes" : "expenseTypes",
          "vehicles" : "filteredVehicles",
          "region" : "report.expenseHeader.region"
        }
      } ], [ {
        "type" : "component",
        "dimension" : {
          "xs" : 6,
          "sm" : 6,
          "md" : 6,
          "lg" : 6
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "text" : {
            "type" : "interpolation",
            "value" : "Cancel"
          },
          "type" : {
            "type" : "constant",
            "value" : "page"
          },
          "targetUrl" : {
            "type" : "constant",
            "value" : "http://"
          },
          "pageToken" : {
            "type" : "constant",
            "value" : "case"
          },
          "processName" : {
            "type" : "constant"
          },
          "processVersion" : {
            "type" : "constant"
          },
          "taskId" : {
            "type" : "constant"
          },
          "caseId" : {
            "type" : "constant"
          },
          "target" : {
            "type" : "constant",
            "value" : "_self"
          },
          "appToken" : {
            "type" : "constant"
          },
          "urlParams" : {
            "type" : "expression",
            "value" : "{\"id\": task.caseId}"
          },
          "alignment" : {
            "type" : "constant",
            "value" : "right"
          },
          "buttonStyle" : {
            "type" : "constant",
            "value" : "primary"
          }
        },
        "reference" : "1f2e55e8-4add-42ff-b1e2-bab130dda443",
        "hasValidationError" : false,
        "id" : "pbLink"
      }, {
        "type" : "component",
        "dimension" : {
          "xs" : 6,
          "sm" : 6,
          "md" : 6,
          "lg" : 6
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "constant",
            "value" : false
          },
          "disabled" : {
            "type" : "expression",
            "value" : "$form.$invalid"
          },
          "label" : {
            "type" : "interpolation",
            "value" : "Add"
          },
          "alignment" : {
            "type" : "constant",
            "value" : "left"
          },
          "buttonStyle" : {
            "type" : "constant",
            "value" : "success"
          },
          "action" : {
            "type" : "constant",
            "value" : "Submit task"
          },
          "assign" : {
            "type" : "constant",
            "value" : true
          },
          "url" : {
            "type" : "interpolation"
          },
          "responseStatusCode" : {
            "type" : "variable",
            "value" : ""
          },
          "dataToSend" : {
            "type" : "expression",
            "value" : "formOutput"
          },
          "dataFromSuccess" : {
            "type" : "variable",
            "value" : ""
          },
          "closeOnSuccess" : {
            "type" : "constant",
            "value" : false
          },
          "dataFromError" : {
            "type" : "variable",
            "value" : ""
          },
          "targetUrlOnSuccess" : {
            "type" : "interpolation",
            "value" : "?id={{task.caseId}}"
          },
          "collectionToModify" : {
            "type" : "variable"
          },
          "modalId" : {
            "type" : "constant",
            "value" : ""
          },
          "collectionPosition" : {
            "type" : "constant",
            "value" : "Last"
          },
          "valueToAdd" : {
            "type" : "constant"
          },
          "removeItem" : {
            "type" : "variable"
          }
        },
        "reference" : "47bb22c1-e29e-4ae6-93ed-277d97c7a54a",
        "hasValidationError" : false,
        "id" : "pbButton"
      } ] ]
    }
  } ] ],
  "assets" : [ {
    "id" : "affe00a9-5637-40eb-ac68-a98f87a6f842",
    "name" : "style.css",
    "type" : "css",
    "order" : 0,
    "external" : false
  }, {
    "id" : "4255475b-bb75-49a2-af4d-d1cc89cb699b",
    "name" : "localization.json",
    "type" : "json",
    "order" : 0,
    "external" : false
  } ],
  "inactiveAssets" : [ ],
  "data" : {
    "formInput" : {
      "type" : "expression",
      "value" : "var region = $data.regions.find(function(e) {\n   return e.name === $data.report.expenseHeader.region;\n});\nvar currency = region ? region.defaultCurrency.name : $data.currencies[0].name;\n\nreturn {\n    \"vehicleType\":$data.filteredVehicles[0].name,\n    \"expenseType\":$data.expenseTypes[0].type,\n    \"currency\":currency\n};",
      "exposed" : false
    },
    "formOutput" : {
      "type" : "expression",
      "value" : "var isKm = $data.isKm;\nreturn {\n    \"description\": $data.formInput.description,\n    \"expenseDate\": $data.formInput.expenseDate,\n    \"currency\": isKm? \"\" : $data.formInput.currency,\n    \"isKm\": isKm,\n    \"expenseType\": $data.formInput.expenseType,\n    \"amount\": isKm ? $data.kmAmount : $data.formInput.amount,\n    \"km\": isKm ? $data.formInput.km : 0,\n    \"vehicleType\": isKm ? $data.formInput.vehicleType : \"\"\n}",
      "exposed" : false
    },
    "context" : {
      "type" : "url",
      "value" : "../API/bpm/userTask/{{taskId}}/context",
      "exposed" : false
    },
    "isKm" : {
      "type" : "expression",
      "value" : "if ($data.formInput.expenseType) {\n    var type = $data.expenseTypes.find(function(e){\n        return e.type == $data.formInput.expenseType\n    })\n    return type ? type.type === \"KM\" : false\n}\nreturn false",
      "exposed" : false
    },
    "kmAmount" : {
      "type" : "expression",
      "value" : "var vehicle = $data.vehicles.find(function(e){\n    return e.name == $data.formInput.vehicleType\n})\nreturn vehicle\n    ? vehicle.rate * $data.formInput.km \n    : null",
      "exposed" : false
    },
    "user" : {
      "type" : "url",
      "value" : "../API/system/session/1",
      "exposed" : false
    },
    "task" : {
      "type" : "url",
      "value" : "../API/bpm/userTask/{{taskId}}",
      "exposed" : false
    },
    "taskId" : {
      "type" : "urlparameter",
      "value" : "id",
      "exposed" : false
    },
    "currencies" : {
      "type" : "url",
      "value" : "../API/bdm/businessData/com.bonita.lr.model.ExpenseCurrency?q=find&p=0&c=100",
      "exposed" : false
    },
    "expenseTypes" : {
      "type" : "url",
      "value" : "../API/bdm/businessData/com.bonita.lr.model.ExpenseType?q=find&p=0&c=100",
      "exposed" : false
    },
    "vehicles" : {
      "type" : "url",
      "value" : "../API/bdm/businessData/com.bonita.lr.model.ExpenseVehicle?q=find&p=0&c=100",
      "exposed" : false
    },
    "report" : {
      "type" : "url",
      "value" : "../{{context.expenseReport_ref.link}}",
      "exposed" : false
    },
    "filteredVehicles" : {
      "type" : "expression",
      "value" : "return $data.vehicles.filter(vehicle => vehicle.region.name === $data.report.expenseHeader.region);",
      "exposed" : false
    },
    "regions" : {
      "type" : "url",
      "value" : "../API/bdm/businessData/com.bonita.lr.model.Region?q=find&p=0&c=100",
      "exposed" : false
    }
  },
  "hasValidationError" : false,
  "uuid" : "d36167ac-4489-487d-af16-4e6c33cede52",
  "type" : "form",
  "description" : "Page generated with Bonita UI designer"
}